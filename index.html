<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 文字江湖</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="styles/base.css">
    <link rel="stylesheet" href="styles/game.css">
    <link rel="stylesheet" href="styles/components.css">
    <link rel="stylesheet" href="styles/modals.css">
    <link rel="stylesheet" href="styles/skills.css">
</head>
<body class="light-theme">
    <div class="game-container">
        <button id="menu-toggle" class="menu-toggle"><i class="fas fa-bars"></i></button>

        <main id="main-content" class="main-content">
            <header class="story-header">
                <div id="status-bar" class="status-bar">
                    <div class="status-item" id="date-status"><i class="fas fa-calendar-alt"></i> 日期: --</div>
                    <div class="status-item" id="time-status"><i class="fas fa-clock"></i> 時辰: --</div>
                </div>
                <button id="header-toggle-btn" class="header-toggle-btn" title="收起/展開資訊欄">
                    <i class="fas fa-chevron-up"></i>
                </button>
            </header>
            <div id="story-panel" class="story-panel">
                <div id="story-text-wrapper">
                     <p class="system-message">正在連接你的世界，讀取記憶中...</p>
                </div>
            </div>
            <footer class="story-footer">
                <div id="action-suggestion" class="action-suggestion"></div>
                <div class="input-action-wrapper">
                    <input type="text" id="player-input" placeholder="接下來..." autocomplete="off">
                    <button id="submit-button">動作</button>
                </div>
            </footer>
        </main>

        <aside id="dashboard" class="dashboard">
            <div class="dashboard-header">
                <div class="header-buttons">
                    <a href="novel.html" target="_blank" class="header-link-btn" title="閱讀完整小說">
                        <i class="fas fa-book-open"></i>
                    </a>
                    <a href="relations.html" target="_blank" class="header-link-btn" title="人物關係圖">
                        <i class="fas fa-project-diagram"></i>
                    </a>
                    <a href="encyclopedia.html" target="_blank" class="header-link-btn" title="江湖百科">
                        <i class="fas fa-atlas"></i>
                    </a>
                    <a href="bounties.html" target="_blank" class="header-link-btn" title="懸賞告示板">
                        <i class="fas fa-scroll"></i>
                    </a>
                    <button id="theme-switcher" class="theme-switcher" title="切換主題">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button id="suicide-btn" class="header-link-btn" title="了卻此生">
                        <i class="fas fa-skull"></i>
                    </button>
                    <button id="logout-btn" class="header-link-btn" title="登出江湖">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
            <div class="dashboard-content">
                <div class="info-card">
                    <div class="card-header-flex">
                        <h4><i class="fas fa-user"></i> 角色狀態 (PC)</h4>
                        <div class="header-action-group">
                            <span class="header-prompt-text">武學總覽→</span>
                            <button id="skills-btn" class="header-icon-btn" title="查看武學">
                                <i class="fas fa-khanda"></i>
                            </button>
                        </div>
                    </div>
                    <div id="pc-content">--</div>
                    <div class="power-display">
                        <span class="power-label">內功</span>
                        <div class="power-bar-container">
                            <div id="internal-power-bar" class="power-bar"></div>
                        </div>
                        <span id="internal-power-value" class="power-value">--/999</span>
                    </div>
                    <div class="power-display">
                        <span class="power-label">外功</span>
                        <div class="power-bar-container">
                            <div id="external-power-bar" class="power-bar"></div>
                        </div>
                        <span id="external-power-value" class="power-value">--/999</span>
                    </div>
                    <div class="power-display">
                        <span class="power-label">輕功</span>
                        <div class="power-bar-container">
                            <div id="lightness-power-bar" class="power-bar"></div>
                        </div>
                        <span id="lightness-power-value" class="power-value">--/999</span>
                    </div>
                </div>

                <div class="info-card">
                    <h4><i class="fa-solid fa-scale-unbalanced"></i> 立場傾向</h4>
                    <div id="morality-display" class="morality-display-container">
                        <span class="morality-label evil">邪</span>
                        <div class="morality-bar-background">
                            <div id="morality-bar-indicator" class="morality-bar-indicator"></div>
                        </div>
                        <span class="morality-label justice">正</span>
                    </div>
                </div>
                
                <div class="info-card">
                    <h4><i class="fas fa-sack-dollar"></i> 錢袋</h4>
                    <div id="money-content" class="money-display">-- 文錢</div>
                </div>

                <div class="info-card">
                    <h4><i class="fas fa-briefcase"></i> 隨身物品 (ITM)</h4>
                    <div id="itm-content">--</div>
                </div>

                <div class="info-card">
                    <h4><i class="fas fa-users"></i> 人物見聞 (NPC)</h4>
                    <div id="npc-content">--</div>
                </div>

                <div class="info-card">
                    <h4><i class="fas fa-scroll"></i> 任務日誌 (QST)</h4>
                    <div id="qst-content">--</div>
                </div>

                 <div class="info-card">
                    <h4><i class="fas fa-brain"></i> 內心獨白 (PSY)</h4>
                    <div id="psy-content">--</div>
                </div>
                
                <div class="info-card">
                    <h4><i class="fas fa-key"></i> 關鍵線索 (CLS)</h4>
                    <div id="cls-content">--</div>
                </div>
                
                <div class="info-card">
                    <h4><i class="fas fa-brain-circuit"></i> AI 核心</h4>
                    <div class="select-wrapper">
                        <select id="ai-model-selector">
                            <option value="gemini">Gemini (快 & 穩)</option>
                            <option value="openai" selected>GPT (強 & 貴)</option>
                            <option value="deepseek">DeepSeek (強 & 奇)</option>
                            <option value="grok">Grok (快 & 怪)</option>
                        </select>
                    </div>
                    <small class="ai-switcher-note">注意：更換核心後，故事風格與文筆將會改變。</small>
                </div>
            </div>
        </aside>

        <div id="epilogue-modal" class="epilogue-modal-overlay">
            <div class="epilogue-modal-content">
                <header class="epilogue-modal-header">
                    <h2 id="epilogue-title">江湖路遠 有緣再會</h2>
                </header>
                <div id="epilogue-story" class="epilogue-modal-body">
                    <div class="loading-placeholder">
                        <p>史官正在為您的人生撰寫終章...</p>
                        <div class="loader-dots">
                            <span></span><span></span><span></span>
                        </div>
                    </div>
                </div>
                <footer class="epilogue-modal-footer">
                    <button id="close-epilogue-btn" class="epilogue-btn">查看結局</button>
                </footer>
            </div>
        </div>

        <div id="deceased-overlay" class="deceased-overlay">
            <div class="deceased-content">
                <i class="fas fa-book-dead"></i>
                <h2 id="deceased-title">江湖路遠，就此終焉</h2>
                <p id="deceased-message">你已身故。此世的傳奇已載入史冊，永世流傳。</p>
                <div class="deceased-actions">
                    <a href="library.html" target="_blank" class="deceased-btn review-btn">
                        <i class="fas fa-book-open-reader"></i> 回顧生平事蹟
                    </a>
                    <a href="register.html" class="deceased-btn restart-btn">
                        <i class="fas fa-user-plus"></i> 註冊新名號
                    </a>
                </div>
            </div>
        </div>
        
        <div id="combat-modal" class="combat-modal-overlay">
            <div class="combat-modal-content">
                <div class="combat-header">
                    <h3 id="combat-title">遭遇戰</h3>
                    <div id="combat-enemies" class="combat-enemies-list"></div>
                </div>
                <div id="combat-log" class="combat-log-area">
                </div>
                <div class="combat-input-area">
                    <input type="text" id="combat-input" placeholder="你想如何應對？..." autocomplete="off">
                    <button id="combat-action-btn">行動</button>
                </div>
                <div id="combat-loader" class="combat-loader-overlay">
                    <div class="loader-dots">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
            </div>
        </div>

        <div id="chat-modal" class="chat-modal-overlay">
            <div class="chat-modal-content">
                <div class="chat-header">
                    <h3 id="chat-npc-name">與...交談</h3>
                    <div id="chat-npc-info" class="chat-npc-info-list"></div>
                    <div class="chat-close-container">
                        <small class="chat-close-tip">(取消對話)</small>
                        <button id="close-chat-btn" class="chat-close-btn" title="關閉視窗"><i class="fas fa-times"></i></button>
                    </div>
                </div>
                <div id="chat-log" class="chat-log-area">
                </div>
                <div class="chat-input-area">
                    <input type="text" id="chat-input" placeholder="你說..." autocomplete="off">
                    <button id="chat-action-btn">發送</button>
                    <button id="give-item-btn" class="chat-action-btn give-item-btn" title="贈予物品或金錢">
                        <i class="fas fa-hand-holding-dollar"></i>
                    </button>
                </div>
                <div class="chat-footer">
                    <button id="end-chat-btn" class="end-chat-btn">結束交談</button>
                </div>
                 <div id="chat-loader" class="chat-loader-overlay">
                    <div class="loader-dots">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
            </div>
        </div>

        <div id="give-item-modal" class="chat-modal-overlay">
            <div class="chat-modal-content">
                <div class="chat-header">
                    <h3 id="give-item-title">要贈予什麼？</h3>
                    <button id="cancel-give-btn" class="chat-close-btn" title="取消贈予"><i class="fas fa-times"></i></button>
                </div>
                <div id="give-inventory-list" class="chat-log-area">
                    </div>
                <div class="chat-footer">
                    <p>選擇一項物品來贈予。</p>
                </div>
            </div>
        </div>

        <div id="skills-modal" class="skills-modal-overlay">
            <div class="skills-modal-content">
                <div class="skills-modal-header">
                    <h3>武學總覽</h3>
                    <button id="close-skills-btn" class="skills-modal-close"><i class="fas fa-times"></i></button>
                </div>
                <div class="skills-modal-tabs" id="skills-tabs-container">
                    </div>
                <div class="skills-modal-body" id="skills-body-container">
                    </div>
            </div>
        </div>

    </div>

    <script type="module" src="scripts/main.js"></script>
</body>
</html>
